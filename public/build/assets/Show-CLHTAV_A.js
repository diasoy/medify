import{r as o,j as e,a as p,b as h,f as u}from"./app-AIDFTJRs.js";import{A as j}from"./AuthenticatedLayout-DBkp5rbV.js";import"./ApplicationLogo-CSuGBocz.js";import"./transition-B4OsJkZg.js";function w({order:s,auth:m}){const[n,l]=o.useState(!1),[r,i]=o.useState(!1),x=()=>{i(!0),h.get(`/order/${s.id}/pdf`,{responseType:"blob"}).then(t=>{const d=new Blob([t.data],{type:"application/pdf"}),c=window.URL.createObjectURL(d),a=document.createElement("a");a.href=c,a.setAttribute("download",`order-${s.id}.pdf`),document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(c),document.body.removeChild(a),i(!1)}).catch(t=>{console.error("Error downloading PDF:",t),alert("Failed to download PDF. Please try again."),i(!1)})};return e.jsxs(j,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight",children:"Order Details"}),children:[e.jsx(p,{title:`Order #${s.id}`}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-3xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-base-100 shadow-xl rounded-xl p-8",children:[e.jsxs("div",{className:"mb-8 border-b pb-4 flex flex-col md:flex-row md:justify-between md:items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"INVOICE"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[e.jsx("strong",{children:"Order ID:"})," ",s.id]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[e.jsx("strong",{children:"Date Time:"})," ",new Date(s.created_at).toLocaleString()]})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Shipping Status:"})," ",e.jsx("span",{className:`badge ml-2 ${b(s.shipping_status)}`,children:s.shipping_status})]})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"font-semibold mb-1",children:"Shipping Address"}),e.jsx("div",{className:"bg-base-200 rounded p-3",children:e.jsx("p",{className:"mb-0",children:s.shipping_address})})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Order Items"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"table table-zebra w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Qty"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Subtotal"})]})}),e.jsx("tbody",{children:s.items&&s.items.length>0?s.items.map((t,d)=>e.jsxs("tr",{children:[e.jsx("td",{children:d+1}),e.jsx("td",{children:t.product?t.product.title:e.jsx("span",{className:"italic text-gray-400",children:"Product deleted"})}),e.jsx("td",{children:t.quantity}),e.jsx("td",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(t.price)}),e.jsx("td",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(t.price*t.quantity)})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center text-gray-400",children:"No items found"})})}),e.jsxs("tfoot",{children:[e.jsxs("tr",{children:[e.jsx("th",{colSpan:4,className:"text-right",children:"Subtotal"}),e.jsx("th",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(s.total_price)})]}),e.jsxs("tr",{children:[e.jsx("th",{colSpan:4,className:"text-right",children:"Tax (11%)"}),e.jsx("th",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Math.round(s.total_price*.11))})]}),e.jsxs("tr",{className:"font-bold",children:[e.jsx("th",{colSpan:4,className:"text-right",children:"Total Payment"}),e.jsx("th",{children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(s.total_payment)})]})]})]})})]}),s.payment_status==="success"&&e.jsx("div",{className:"mb-6 alert alert-success",children:e.jsxs("span",{children:[e.jsx("strong",{children:"Payment Successful!"})," Thank you, your payment has been received and your order is being processed.",s.shipping_status==="pending"&&" We'll notify you when your order ships."]})}),m.user.role==="admin"&&s.payment_status==="success"&&s.shipping_status==="pending"&&e.jsx("div",{className:"mb-6 alert alert-info",children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("span",{children:[e.jsx("strong",{children:"Admin Actions:"})," Mark this order as shipped if ready."]}),e.jsx("button",{className:`btn btn-primary btn-sm ${n?"loading":""}`,onClick:()=>{l(!0),h.patch(`/order/${s.id}/shipping`,{shipping_status:"shipped"}).then(t=>{t.data.success?u.reload():(alert("Error updating status: "+t.data.message),l(!1))}).catch(t=>{console.error("Error updating shipping status:",t),alert("Failed to update shipping status. Please try again."),l(!1)})},disabled:n,children:n?"Updating...":"Mark as Shipped"})]})}),e.jsxs("div",{className:"mt-8 flex justify-end",children:[e.jsx("button",{className:`btn btn-secondary ${r?"loading":""}`,onClick:x,disabled:r,children:r?"Downloading...":"Download PDF"}),e.jsx("button",{className:"btn",onClick:()=>window.history.back(),children:"Back to Orders"})]})]})})})]})}const b=s=>{switch(s){case"delivered":return"badge-success";case"shipped":return"badge-info";case"pending":return"badge-warning";case"cancelled":return"badge-error";default:return"badge-ghost"}};export{w as default};
