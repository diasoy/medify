import{r as s,j as t,b as N,f as m}from"./app-AIDFTJRs.js";var P={};function C({cartItems:k,total:w}){const[o,c]=s.useState(!1),[i,n]=s.useState(null),[a,p]=s.useState(""),[l,h]=s.useState(""),[d,g]=s.useState(null),[u,f]=s.useState(null);s.useEffect(()=>{const e="https://app.sandbox.midtrans.com/snap/snap.js",b=P.MIX_MIDTRANS_CLIENT_KEY;let r=document.createElement("script");return r.src=e,r.setAttribute("data-client-key",b),document.body.appendChild(r),()=>{document.body.removeChild(r)}},[]);const x=async()=>{if(!a){n("Please enter your shipping address");return}if(!l){n("Please enter your phone number");return}c(!0),n(null);try{const e=await N.post("/checkout",{address:a,phone_number:l});e.data.snapToken&&(g(e.data.snapToken),f(e.data.orderId)),e.data.error&&n(e.data.error)}catch{n("An error occurred while processing your order. Please try again.")}finally{c(!1)}},y=()=>{d&&window.snap.pay(d,{onSuccess:function(e){console.log("Payment Success:",e),m.get(`/order/${u}`,{},{preserveScroll:!0})},onPending:function(e){console.log("Payment Pending:",e),m.get(`/order/${u}`,{},{preserveScroll:!0})},onError:function(e){console.log("Payment Error:",e),n("Payment failed. Please try again.")},onClose:function(){console.log("Payment Popup Closed")}})};return t.jsxs("div",{className:"max-w-md mx-auto mt-10 p-6 bg-white rounded-lg shadow-md",children:[t.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Checkout"}),i&&t.jsx("div",{className:"text-red-500 mb-4",children:i}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Shipping Address"}),t.jsx("input",{type:"text",value:a,onChange:e=>p(e.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring focus:ring-opacity-50"})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone Number"}),t.jsx("input",{type:"text",value:l,onChange:e=>h(e.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring focus:ring-opacity-50"})]}),t.jsx("button",{onClick:x,disabled:o,className:`w-full py-2 px-4 bg-blue-600 text-white rounded-md ${o?"opacity-50":""}`,children:o?"Processing...":"Checkout"}),d&&t.jsx("button",{onClick:y,className:"w-full mt-4 py-2 px-4 bg-green-600 text-white rounded-md",children:"Pay Now"})]})}export{C as default};
