import{r as x,j as e,a as w,J as v,f as h,q as C,S as _}from"./app-AIDFTJRs.js";import{A as S}from"./AuthenticatedLayout-DBkp5rbV.js";import{P}from"./Pagination-tbgjxAT8.js";import{A as k}from"./AlertDelete-DROSbcZA.js";import{f as A}from"./formatRupiah--QECpPMs.js";import"./ApplicationLogo-CSuGBocz.js";import"./transition-B4OsJkZg.js";const I=({products:t})=>{var o;const[r,l]=x.useState(!1),[d,c]=x.useState(null),g=a=>{c(a),l(!0)},j=a=>{h.get(a,{},{preserveScroll:!0})},n=()=>{d&&h.delete(route("products.destroy",d),{preserveScroll:!0}),l(!1),c(null)},m=()=>{l(!1),c(null)};return e.jsxs(S,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight",children:"Product Management"}),children:[e.jsx(w,{title:"Products"}),e.jsx("div",{className:"",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(v,{href:route("products.create"),className:"btn btn-primary",children:"Add New Product"})}),e.jsxs("table",{className:"table table-zebra w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Gambar"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:((o=t==null?void 0:t.data)==null?void 0:o.length)>0?t.data.map(a=>{var u;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{src:`/storage/${a.linkImage}`,alt:a.title,className:"w-16 h-16 object-cover"})}),e.jsx("td",{children:a.title}),e.jsx("td",{children:((u=a.category)==null?void 0:u.name)||"N/A"}),e.jsx("td",{children:A(a.price)}),e.jsxs("td",{className:"flex gap-2",children:[e.jsx(v,{href:route("products.edit",a.id),className:"btn btn-warning",children:"Edit"}),e.jsx("button",{onClick:()=>g(a.id),className:"btn btn-error",children:"Delete"})]})]},a.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-center",children:"No products found."})})})]}),e.jsx(P,{links:t.links,onPageChange:j})]})}),e.jsx(k,{description:"Are you sure you want to delete this product?",isOpen:r,onConfirm:n,onCancel:m})]})};function D(t,r){const[l,d]=x.useState(t);return x.useEffect(()=>{const c=setTimeout(()=>{d(t)},r);return()=>{clearTimeout(c)}},[t,r]),l}const q=({products:t,categories:r})=>{var f,p,b,y;const{props:l}=C(),[d,c]=x.useState(!0),g=((p=(f=l.ziggy)==null?void 0:f.query)==null?void 0:p.category_id)||"",j=((y=(b=l.ziggy)==null?void 0:b.query)==null?void 0:y.search)||"",{data:n,setData:m}=_({category_id:g,search:j}),o=D(n.search,500);x.useEffect(()=>{var i,N;if(d){c(!1);return}const s={};o!==""&&(s.search=o),n.category_id!==""&&(s.category_id=n.category_id),(N=(i=l.ziggy)==null?void 0:i.query)!=null&&N.page&&(s.page=1),h.get(route("products.index"),s,{preserveState:!0,replace:!0})},[o,n.category_id]);const a=s=>{const i=s.target.value;m("category_id",i)},u=s=>{new URL(s).searchParams.get("page"),n.search,n.category_id,h.visit(s,{data:{},preserveScroll:!0,preserveState:!0,replace:!1})};return e.jsxs(S,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight",children:"Products Ready"}),children:[e.jsx(w,{title:"Products"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-4 mb-6",children:[e.jsx("div",{className:"w-full sm:w-1/2",children:e.jsxs("select",{className:"select select-bordered w-full max-w-xs",value:n.category_id,onChange:a,children:[e.jsx("option",{value:"",children:"All Categories"}),r==null?void 0:r.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})}),e.jsx("div",{className:"w-full sm:w-1/2",children:e.jsx("input",{type:"text",placeholder:"Search products...",className:"input input-bordered w-full max-w-xs",value:n.search,onChange:s=>m("search",s.target.value)})})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:t.data.length>0?t.data.map(s=>{var i;return e.jsxs("div",{className:"card bg-base-100 shadow-md",children:[e.jsx("figure",{children:e.jsx("img",{src:`/storage/${s.linkImage}`,alt:s.title,className:"w-full h-48 object-cover"})}),e.jsxs("div",{className:"card-body",children:[e.jsx("h2",{className:"card-title",children:s.title}),e.jsx("p",{className:"text-sm text-gray-500",children:((i=s.category)==null?void 0:i.name)||"N/A"}),e.jsx("p",{className:"text-lg font-bold",children:A(s.price.toString())}),e.jsxs("div",{className:"flex w-full justify-between mt-4",children:[e.jsx("button",{className:"btn btn-primary w-24",onClick:()=>h.visit(route("products.show",s.id)),children:"View"}),e.jsx("button",{className:"btn btn-success w-24",onClick:()=>h.post(route("cart.store"),{product_id:s.id,quantity:1}),children:"Buy"})]})]})]},s.id)}):e.jsx("p",{className:"text-center col-span-full",children:"No products found."})}),e.jsx(P,{links:t.links,onPageChange:u})]})})]})};function J({products:t,categories:r}){const{auth:l}=C().props;return l.user.role==="admin"?e.jsx(I,{products:t}):l.user.role==="customer"?e.jsx(q,{products:t,categories:r}):e.jsx("div",{children:"Unauthorized"})}export{J as default};
